## 動画ファイル

動画ファイルは「映像」と「音声」の2つファイルに分かれ、それぞれ対応するコーディックの規格がある。

「映像」と「音声」の2つファイルを同梱できる動画ファイルを「コンテナファイル」という。

## コーディックとは

映像や音声データをエンコード、デコードするプログラムのこと。

動画作成時のエンコードに使用したコーディックを、試聴環境でデコードできれば動画が再生され、なければエラーとなる。（映像、音声それぞれ）

```
映像コーデック：MPEG-1、MPEG-2、MPEG-4 Visual、H.264/MPEG-4 AVC、H.265など
音声コーデック：AAC、HE-AAC、MP1、MP2、MP3、MPEG-4 ALS、TwinVQ、CELPなど
```

## フレームレート（fps）

1秒間の動画が何枚の画像で構成されているかを示す単位。fps「frames per second」の略。

一般的に？24fps〜30fps程度で30fps程度の動画であれば違和感を感じることは少ない？

## ビットレート(bps)
1秒あたりのデータ量のことを示す単位。bps「bit per second」の略。

動画のビットレートには「映像」と「音声」の2種類がある。また、2つを合わせたものを総ビットレート（オーバービットレート）という。

### 音声のビットレート
```
MP3、AAC、WMAなど非可逆コーデック…96kbps～128kbps程度
音質重視の動画…192～320kbps程度
```
### 映像ビットレート
配信したい画質によって値が異なる。

以下参考値

<img width="748" alt="スクリーンショット 2022-10-16 11 22 36" src="https://user-images.githubusercontent.com/49969297/196014901-4f23f5f2-9447-4b07-8828-680c3c2e2c91.png">

※https://www.stream.co.jp/blog/blogpost-32369/

## FFmpeg

動画と音声を加工等が出来るフリーソフト。

### 動画サイズ、コーディック
```
$ ffprobe -i 入力ファイル名
```

動画の長さ、サイズ、コーディック、ビットレート等を確認できる。

### HLSに対応するため、m3u8 , tsを生成

コマンド
```
$ ffmpeg -i video.mp4 -c:v copy -c:a copy -f hls -hls_time 5 -hls_playlist_type vod -hls_segment_filename "video%3d.ts" video.m3u8
```

オプション
```
-i ファイル名                         # inputファイルの指定
-c:v copy 　　　                        # 映像データのコピー
-c:a copy 　　　                        # 音声データのコピー
-f hls    　　　                        # フォーマットの指定(hls)
-hls_time　秒数                       # 動画を分割する際の間隔の指定。単位は秒。
-hls_playlist_type vod              # HLSのタイプを指定します。
-hls_segment_filename "video%3d.ts" # 小さく分割した動画ファイルの名前の指定。%3d と指定していることで 000、001、...といった三桁のインデックスが割り振られます。
video.m3u8                          # インデックスファイル名
```
